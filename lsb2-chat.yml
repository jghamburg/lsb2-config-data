server:
  port: 9999
#
# details on endpoints: https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html#production-ready-endpoints-exposing-endpoints
management:
  endpoints:
    enabled-by-default: true
    web:
      base-path: /actuator
      exposure:
        include: "*"
        exclude: shutdown
  endpoint:
    health:
      show-details: always
  health:
    diskspace:
      enabled: true
    db:
      enabled: true
    rabbit:
      enabled: true
    elasticsearch:
      enabled: false
    mongo:
      enabled: true
    defaults:
      enabled: false
  info:
    git:
      enabled: true
      mode: simple
  security:
    enabled: true

# Export to /internal/info
info:
  app:
    name: Chat Springboot Application with WebSockets
    description: Springboot - Thymeleaf Application with WebSocket Backend communication
    version: ${appversion}
  javaVersion: ${java.version}

spring:
  cloud:
    config:
      uri: http://localhost:8888
    gateway:
      discovery:
        locator:
          enabled: false
      routes:
      # ========================================================
      - id: imagesService
        uri: http://localhost:8200
        predicates:
        - Path=/imagesService/**
        filters:
        - RewritePath=/imagesService/(?<segment>.*), /$\{segment}
        - RewritePath=/imagesService, /
        - SaveSession
      - id: images
        uri: http://localhost:8200
        predicates:
        - Path=/images/**
        filters:
        - SaveSession
      - id: mainCss
        uri: http://localhost:8200
        predicates:
        - Path=/main.css
        filters:
        - SaveSession
      - id: commentsService
        uri: http://localhost:8200
        predicates:
        - Path=/comments/**
        filters:
        - SaveSession
    stream:
      bindings:
        input:
          destination: learning-spring-boot-chat
          group: comments-chat
          content-type: application/json
        newComments:
          destination: learning-spring-boot-chat
          group: comments-chat
          content-type: application/json
        clientToBroker:
          destination: learning-spring-boot-chat-user-messages
          group: app-chatMessages
        brokerToClient:
          destination: learning-spring-boot-chat-user-messages
          group: topic-chatMessages
  rabbitmq:
    host: ${RABBITMQ_HOST:localhost}
    port: ${RABBITMG_PORT:5672}
    username: ${RABBITMG_USERNAME:guest}
    password: ${RABBITMG_PASSWORD:guest}
  data:
    mongodb:
      host: ${MONGODB_HOST:localhost}
      port: ${MONGODB_PORT:27017}
      database: ${MONGODB_DB_NAME:lsb2db}

security:
  sessions: always

hystrix:
  command:
    default:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 60000
ribbon:
  ConnectTimeout: 3000
  ReadTimeout: 60000
